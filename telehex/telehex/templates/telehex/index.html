{% load staticfiles %}
{% include "./telehex/header.html" %}

<style>
body { background: url('static/img/mainbg.png') repeat #263544; }
#navsearch { display: none !important; }
</style>

<div class="container-fluid">
    <form id="mainsearchform" name="searchform" action="/search/" method="post" class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-6 col-md-offset-3">
        {% csrf_token %}
        <div class="ui-widget" id="test">
            <div class="form-group">
                <input type="text" name="query" placeholder="find a tv show" class="form-control" id="searchtext">
            </div>
        </div>
        <div class="col-xs-12 col-sm-8 col-sm-offset-2  col-md-4 col-md-offset-4">
            <button type="submit" class="btn btn-lg btn-danger" id="searchbutton">search</button>
        </div>
    </form>
</div>

 <script>
  
    $(document).ready(function(){
        $.get( "/search_tags/", function( data ) {
            $( "#searchtext" ).autocomplete({
                appendTo: "#someElem", 
                minLength: 2, 
                source: data.tags, 
                delay: 200,
                select : function(event, ui){ 
                    $("#searchtext").val(ui.item.label);
                    $('#loading-overlay').show()
                    $("#mainsearchform").submit();
                }
            });
        });

        
        var input = $('#searchtext');
        var form = $('.form-group');
        form.jrumble({ speed: 30 }); // Initialise jRumble

        $('#mainsearchform').submit(function() {
            if( !input.val()  ) {
                input.attr('placeholder', 'type something!');
                input.css({'border-color':'#c0392b', 'border-width':'2px'}).focus();
                
                var demoTimeout;
                clearTimeout(demoTimeout);
                form.trigger('startRumble');
                demoTimeout = setTimeout(function(){form.trigger('stopRumble');}, 500)
                
                return false;
            }

            $('#loading-overlay').show();
        });

        input.keypress(function(){
            $(this).css({'border-color':'', 'border-width':''});
        });

    });

  </script>
{% include "./telehex/footer.html" %}
